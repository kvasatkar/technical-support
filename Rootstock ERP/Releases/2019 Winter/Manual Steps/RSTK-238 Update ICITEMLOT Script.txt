
List< rstk__icitemlot__c> invItemByLotList = new  List< rstk__icitemlot__c>(); 
for(rstk__icitemlot__c invItemLot : [Select rstk__icitemlot_issexpiredate__c, rstk__icitemlot_expiredate__c,rstk__icitemlot_item__r.rstk__icitem_ltexpirefrm__c From rstk__icitemlot__c where rstk__icitemlot_issexpiredate__c = null Limit 2000])
{
	if(rstk__icitemlot__c.rstk__icitemlot_expiredate__c != null && rstk__icitemlot__c.rstk__icitemlot_item__r.rstk__icitem_ltexpirefrm__c != null){
		rstk__invItemLot__c.rstk__icitemlot_issexpiredate__c = rstk__icitemlot__c.rstk__icitemlot_expiredate__c.addDays(-rstk__icitemlot__c.rstk__icitemlot_item__r.rstk__icitem_ltexpirefrm__c.intValue());
		invItemByLotList.add(invItemLot);
		System.debug('invItemByLotList = ' +invItemByLotList);
	}
}
 
if(!invItemByLotList.isEmpty()){
	update invItemByLotList;
}

